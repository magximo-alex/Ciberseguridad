import requests

# Clave API (no la compartas públicamente)
API_KEY = "2e439fb9a4e989b8de6dc8c37410fed84dd0b1f5a7bf12c8a6416189e42f096439f207e36ccc3011"

# Ruta del archivo con las IPs
IP_FILE = "ips.txt"

# Carga las IPs desde el archivo (una por línea)
with open(IP_FILE, "r") as file:
    ips = [line.strip() for line in file if line.strip()]

# Itera y consulta cada IP
for ip in ips:
    url = f"https://api.abuseipdb.com/api/v2/check?ipAddress={ip}&maxAgeInDays=90"
    headers = {
        "Accept": "application/json",
        "Key": API_KEY
    }
    response = requests.get(url, headers=headers)

    if response.status_code == 200:
        data = response.json()["data"]
        print(f"IP: {ip}")
        print(f"  - Score: {data['abuseConfidenceScore']}")
        print(f"  - Reports: {data['totalReports']}")
        print(f"  - Country: {data['countryCode']}")
        print(f"  - Domain: {data.get('domain', 'N/A')}")
        print(f"  - Last Reported At: {data.get('lastReportedAt', 'Never')}")
        print("-" * 40)
    else:
        print(f"Error al consultar {ip}: {response.status_code}")
